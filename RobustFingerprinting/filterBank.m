function [p]=filterBank(x,Fs)

%Fc=[300 318.325 337.77 358.395 380.28 403.51 428.15 454.3 482.05 511.49 542.735 575.885 611.06 ...
 %  648.385 687.99 730.01 774.5967 821.91 872.11 925.38 981.91 1041.88 1105.52 1173.05 ...
  % 1244.7 1320.72 1401.38 1486.96 1577.78 1674.13 1776.37 1884.87 2000];

Fc=[16 19.01 22.59 26.84 31.9 37.91 45.05 53.54 63.62 75.6 89.84 106.76 126.86 ...
    150.75 179.15 212.89 252.98 300.62 357.24 424.52 504.46 599.46 712.36 846.52 ...
    1005.94 1195.39 1420.51 1688.03 2005.93 2388.7 2832.62 3366.08 4000];

l=33; %length(Fc);
m=length(x);

for i=1:l
    if i>13
        [B,A]=coefDes(Fc(i),Fs,3);
    else
        [B,A]=coefDes(Fc(i),Fs,2);
    end
    stability=isstable(B,A);
    if stability==0
        error('filter not stable');
    end
    y=filter(B,A,x);
    p(i)=sum(y.^2)/m;
end
end

%300*x=309.014  1.0295

%1.061 from one central freq to the other

